<template-hook hook="category-before" />

<!-- Category Title -->

<div class="category">
  <div>
    <div class="title">
      <div ng-click="CategoryCtrl.toggle()" class="collapse-section">
        <a ng-class="{ 'fa-chevron-right' : CategoryCtrl.toggles, 'fa-chevron-down': !CategoryCtrl.toggles }"
          class="fa collapse-btn no-select"></a>
        <h4 ng-bind-html="::CategoryCtrl.category.name"></h4>
      </div>
      <div class="thin-underline"></div>
    </div>
  </div>
<div>
<!-- Boards in Category -->
<div slide-toggle="CategoryCtrl.toggles">
  <div class="board" ng-repeat="board in CategoryCtrl.boards track by board.id">
    <!-- Board Info -->
    <div class="info">
      <!-- Board Name -->
      <h5>
        <a ui-sref="board.data({ boardId: board.id })" class="board-name" ng-bind-html="board.name"></a>
      </h5>
      <!-- Moderators -->
      <div ng-if="board.moderators.length > 0">
        <strong>Moderators: </strong>
        <a ui-sref="profile({ username: mod.username })" ng-repeat="mod in board.moderators" ng-bind="::mod.username + ($last ? '' : ', ')"></a>
      </div>
      <!-- Board Description -->
      <div class="description" ng-bind-html="::board.description"></div>

      <!-- Child Boards -->
      <div class="childboards" ng-if="board.children.length > 0">
        <strong>Child Boards:</strong>
        <span ng-repeat="child in board.children">
          <a ui-sref="board.data({ boardId: child.id })" class="board-name" ng-bind-html="::child.name"></a>{{$last ? '' : ', '}}
        </span>
      </div>
    </div>

    <!-- Board Posts and Threads -->
    <div class="view-count">
      <div>
        <strong ng-bind="::board.total_post_count | number:0"></strong> posts
      </div>
      <div>
        <strong ng-bind="::board.total_thread_count | number:0"></strong> threads
      </div>
    </div>

    <!-- Board Last Post By -->
    <div class="last-post">
      <div ng-if="board.last_post_username">
        Last post by
        <a ui-sref="profile({ username: board.last_post_username })" ng-bind-html="::board.last_post_username"></a>
      </div>
      <div ng-if="board.last_thread_title">
        in thread
        <a ui-sref="posts.data({ threadId: board.last_thread_id, start: board.last_post_position })" ng-bind-html="::board.last_thread_title | truncate:25"></a>
      </div>
      <div ng-if="board.last_post_created_at">
        <i ng-bind="::board.last_post_created_at | humanDate"></i>
      </div>
    </div>

  </div>
</div>

<template-hook hook="category-after" />
